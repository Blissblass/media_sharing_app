(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{51:function(e,t,n){},57:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var s=n(4),c=n(1),i=n(14),o=n.n(i),r=n(11),a=n(5),l=Object(c.createContext)(null),d=(n(51),{black:"#363636",white:"#F8F8F8",grey:"#EBEBEB",blue:"#3F87EA"}),j=n(61),u=n(2),b=function(e){return e.user?Object(u.jsxs)("div",{className:"me-3",children:[Object(u.jsx)(r.b,{to:"/user/".concat(e.user.id),children:Object(u.jsx)(j.a,{type:"button",variant:"outline-primary",size:"lg",className:"me-5 ms-5",children:e.user.username})}),Object(u.jsx)(j.a,{type:"button",variant:"outline-primary",size:"lg",onClick:function(){localStorage.removeItem("user"),e.setUser(null)},children:"Log Out"})]}):Object(u.jsxs)("div",{className:"me-3",children:[Object(u.jsx)(r.b,{to:"/login",children:Object(u.jsx)(j.a,{type:"button",variant:"outline-primary",size:"lg",className:"me-5 ms-5",children:"Log in"})}),Object(u.jsx)(r.b,{to:"/signup",children:Object(u.jsx)(j.a,{type:"button",variant:"outline-primary",size:"lg",children:"Sign Up"})})]})},h=function(e){var t=Object(c.useContext)(l),n=t.user,s=t.setUser;return Object(u.jsxs)("nav",{style:{backgroundColor:d.black},className:"navbar navbar-dark navbar-expand-lg justify-content-between align-items-center shadow",children:[Object(u.jsx)("h3",{style:{fontSize:40,color:d.white},className:"navbar-brand m-3 ms-2 ",children:Object(u.jsx)(r.b,{to:"/",className:"text-decoration-none text-white border-end  p-3",children:"Sound.io"})}),Object(u.jsx)(b,{user:n,setUser:s})]})},m=n(64),O=function(e){var t=Object(c.useState)(!0),n=Object(s.a)(t,2),i=n[0],o=n[1];return Object(u.jsx)(m.a,{className:"position-relative container opacity-75",show:i,variant:"secondary",onClose:function(){return o(!1)},dismissible:!0,children:Object(u.jsx)(m.a.Heading,{children:"".concat(e.head," ").concat(e.notif)})})},f=function(e){return e.notifs?Object(u.jsx)("div",{className:"position-absolute top-50 ms-5",children:Object.keys(e.notifs).map((function(t){return Object(u.jsx)(O,{head:t,notif:e.notifs[t][0]},t)}))}):null},p=n(27),x=n.n(p),g=n(38),y=n(45),v=function(e){var t=Object(c.useState)(e.likes),n=Object(s.a)(t,2),i=n[0],o=n[1],a=Object(c.useState)(!1),l=Object(s.a)(a,2),d=l[0],j=l[1],b=Object(c.useState)(null),h=Object(s.a)(b,2),m=h[0],O=h[1],f=e.setLoading,p=e.song,v=e.currUser;Object(c.useEffect)((function(){(function(){var e=Object(g.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/already_liked",{method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify({id:p.id,liker_id:v.id})}).then((function(e){return e.json()})).then((function(e){e.length>0&&(j(!0),O(e[0])),f(!1)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[f,v.id,p.id]);return Object(u.jsxs)("div",{className:"px-2",style:{display:"flex",alignItems:"center"},children:[Object(u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(u.jsx)("h2",{className:"mb-1 me-2",children:i}),Object(u.jsx)(y.a,{className:"mb-2",style:{fontSize:40,cursor:"pointer",color:d?"#087cfc":"#302c34",marginRight:60},onClick:function(){var t={like:{type:"Song",liker_id:e.currUser.id,id:e.song.id}};d?(fetch("/likes/".concat(m.id),{method:"DELETE"}),j(!1),o((function(e){return e-1}))):(fetch("/likes",{method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){return O(e)})),j(!0),o((function(e){return e+1})))}})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{children:e.title}),Object(u.jsx)("h4",{children:Object(u.jsx)(r.b,{className:"text-secondary text-decoration-none",to:"/user/".concat(e.user.id),children:e.user.username})})]})]})},S=n(24),N=function(e){var t=Object(c.useContext)(l).user;return Object(u.jsx)("div",{className:"card container w-75 mt-4",style:{backgroundColor:d.white},children:Object(u.jsxs)("div",{className:"p-4",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(u.jsx)("div",{children:Object(u.jsx)(v,{song:e.song,title:e.song.title,user:e.song.user,currUser:t,likes:e.song.likes,setLoading:e.setLoading})}),Object(u.jsx)("audio",{controls:!0,style:{width:650},controlsList:"nodownload",children:Object(u.jsx)("source",{src:e.song.media,type:"audio/mp3"})}),t.id===e.song.user.id?Object(u.jsx)(S.b,{style:{fontSize:40,cursor:"pointer"},onClick:function(){fetch("/songs/".concat(e.song.id),{method:"DELETE"}),e.setPosts((function(t){return t.filter((function(t){return t.id!==e.song.id}))}))}}):null]})})},w=n(62),k=n(65),C=function(e){var t=e.setSongs,n=e.setLoading;return Object(c.useLayoutEffect)((function(){(function(){var e=Object(g.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/home_feed").then((function(e){return e.json()})).then((function(e){t(e),n(!1)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,n]),Object(u.jsxs)("div",{className:"mt-3",children:[Object(u.jsx)(w.a,{className:"mx-auto mt-5",style:{display:e.loading?"block":"none",width:100,height:100},animation:"grow",variant:"primary"}),Object(u.jsx)(k.a,{className:"mb-4",style:{visibility:e.loading?"hidden":"visible"},gap:4,children:e.songs.length>0?e.songs.map((function(t){return Object(u.jsx)(N,{song:t,setLoading:e.setLoading,setPosts:e.setSongs},t.id)})):Object(u.jsx)("h1",{style:{display:e.loading?"none":"block"},className:"text-center text-white mt-4",children:"No songs available."})})]})},L=function(e){return Object(u.jsx)(j.a,{type:"button",variant:"outline-primary",size:"lg",style:{position:"fixed",bottom:40,right:35},onClick:e.handleSet,children:"+ New"})},E=n(25),T=n(63),U=function(e){var t=Object(c.useState)(null),n=Object(s.a)(t,2),i=n[0],o=n[1],r=Object(c.useState)(!1),a=Object(s.a)(r,2),d=a[0],b=a[1],h=Object(c.useState)(!1),m=Object(s.a)(h,2),O=m[0],f=m[1],p=Object(c.useContext)(l).user,x=function(){e.handleSet((function(e){return!e}))};return Object(u.jsxs)(T.a,{centered:!0,show:e.show,onHide:x,children:[Object(u.jsx)(T.a.Header,{className:"p-4",closeButton:!0,children:Object(u.jsx)(T.a.Title,{children:"Upload a Song"})}),Object(u.jsx)(T.a.Body,{children:Object(u.jsxs)("form",{id:"songForm",onSubmit:function(t){if(i&&p){t.preventDefault(),f(!0);var n=t.currentTarget[0].value,s=URL.createObjectURL(i),c=new FormData;c.append("song[media]",i),c.append("song[user_id]",p.id),c.append("song[title]",n),fetch("/songs",{method:"POST",body:c}).then((function(e){return e.json()})).then((function(t){t.user=p,t.likes=0,t.media=s,e.setSongs((function(e){return[t].concat(Object(E.a)(e))})),e.handleSet()}))}},children:[Object(u.jsxs)("div",{className:"form-group",children:[Object(u.jsx)("label",{htmlFor:"songTitle",children:"Song Title:"}),Object(u.jsx)("input",{id:"songTitle",type:"text",className:"form-control form-control-lg mt-1",required:!0})]}),Object(u.jsxs)("div",{className:"form-group mt-4",children:[Object(u.jsx)("label",{htmlFor:"songMedia",children:"Song File:"}),Object(u.jsx)("input",{id:"songMedia",type:"file",className:"form-control form-control-lg mt-1",accept:"audio/*",onChange:function(e){var t=e.currentTarget.files[0];(console.log(t),t)&&("audio"===t.type.split("/")[0]?o(t):b(!0))},required:!0,disabled:d}),Object(u.jsx)("small",{className:"mt-1",style:{display:d?"block":"none",textDecoration:"underline",cursor:"pointer"},onClick:function(){o(null),b(!1)},children:"Please select an audio file."})]})]})}),Object(u.jsxs)(T.a.Footer,{children:[Object(u.jsx)(j.a,{variant:"secondary",onClick:x,children:"Close"}),O?Object(u.jsx)(j.a,{type:"submit",variant:"primary",disabled:!0,children:"Uploading..."}):Object(u.jsx)(j.a,{type:"submit",variant:"primary",form:"songForm",children:"Upload"})]})]})},P=function(e){var t=Object(c.useState)(!1),n=Object(s.a)(t,2),i=n[0],o=n[1],r=function(){o((function(e){return!e}))};return Object(u.jsxs)("div",{children:[i?Object(u.jsx)(U,{setSongs:e.setSongs,handleSet:r,show:i}):null,Object(u.jsx)(L,{handleSet:r})]})},_=function(e){var t=Object(c.useState)(""),n=Object(s.a)(t,2),i=n[0],o=n[1],r=e.setSongs;return Object(c.useEffect)((function(){i.length?fetch("/api/song_query/?query=".concat(i)).then((function(e){return e.json()})).then((function(e){return r(e)})):fetch("/api/home_feed").then((function(e){return e.json()})).then((function(e){r(e)}))}),[i,r]),Object(u.jsx)("div",{className:"card container mt-4",style:{width:900,display:e.loading?"none":"block"},children:Object(u.jsxs)("div",{className:"p-4 d-flex align-items-center",children:[Object(u.jsx)("input",{type:"text",className:"form-control form-control-lg me-3",placeholder:"Search for songs...",value:i,onChange:function(e){return o(e.target.value)}}),Object(u.jsx)(S.a,{style:{fontSize:33}})]})})},z=function(e){var t=Object(c.useState)([]),n=Object(s.a)(t,2),i=n[0],o=n[1],r=Object(c.useState)(!0),a=Object(s.a)(r,2),l=a[0],d=a[1];return Object(u.jsxs)("div",{children:[Object(u.jsx)(P,{setSongs:o}),Object(u.jsx)(_,{loading:l,setSongs:o}),Object(u.jsx)(C,{loading:l,setLoading:d,songs:i,setSongs:o})]})},I=function(e){var t=Object(c.useContext)(l).setUser;return Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{className:"text-white w-50 text-center",style:{position:"relative",top:50},children:[Object(u.jsx)("h1",{children:Object(u.jsx)("strong",{children:"Welcome to Sound.io."})}),Object(u.jsx)("h2",{children:"Listen without limits."})]}),Object(u.jsxs)("div",{className:"card container mt-4 me-4 p-4 w-50 float-end text-center shadow-lg",children:[Object(u.jsx)("h1",{children:"Log In"}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault();var s=n.currentTarget,c={user:{email:s[0].value,password:s[1].value}};fetch("/users/sign_in",{method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(n){n.username?(e.setNotifs(null),localStorage.setItem("user",JSON.stringify(n)),t(n)):(e.setNotifs(null),e.setNotifs({"Error:":[n.error]}))}))},children:[Object(u.jsx)("input",{type:"email",className:"form-control form-control-lg mt-3 shadow-sm",placeholder:"Email...",required:!0}),Object(u.jsx)("input",{type:"password",className:"form-control form-control-lg mt-3 shadow-sm",placeholder:"Password...",required:!0}),Object(u.jsx)(j.a,{type:"submit",variant:"outline-primary",size:"lg",className:"me-5 ms-5 mt-4 w-50",children:"Log In"})]})]})]})},J=function(e){var t=Object(c.useContext)(l).setUser;return Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{className:"text-white w-50 text-center",style:{position:"relative",top:50},children:[Object(u.jsx)("h1",{children:Object(u.jsx)("strong",{children:"Welcome to Sound.io."})}),Object(u.jsx)("h2",{children:"Listen without limits."})]}),Object(u.jsxs)("div",{className:"card container mt-4 me-4 p-4 w-50 float-end text-center shadow-lg",children:[Object(u.jsx)("h1",{children:"Sign Up"}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault();var s=n.currentTarget,c={user:{username:s[0].value,email:s[1].value,password:s[2].value,password_confirmation:s[3].value}};fetch("/users",{method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(n){n.username?(e.setNotifs(null),localStorage.setItem("user",JSON.stringify(n)),t(n)):(e.setNotifs(null),e.setNotifs(n.errors))}))},children:[Object(u.jsx)("input",{type:"text",className:"form-control form-control-lg mt-2 shadow-sm",placeholder:"Username..."}),Object(u.jsx)("input",{type:"email",className:"form-control form-control-lg mt-3 shadow-sm",placeholder:"Email..."}),Object(u.jsx)("input",{type:"password",className:"form-control form-control-lg mt-3 shadow-sm",placeholder:"Password..."}),Object(u.jsx)("input",{type:"password",className:"form-control form-control-lg mt-3 shadow-sm",placeholder:"Password Confirmation..."}),Object(u.jsx)(j.a,{type:"submit",variant:"outline-primary",size:"lg",className:"me-5 ms-5 mt-4 w-50",children:"Sign Up"})]})]})]})},D=function(e){return Object(c.useContext)(l).user?Object(u.jsx)(e.element,{}):Object(u.jsx)(a.a,{to:"/login"})},F=function(e){return Object(c.useContext)(l).user?Object(u.jsx)(a.a,{to:"/"}):Object(u.jsx)(e.element,{setNotifs:e.setNotifs})},H=function(e){var t=Object(c.useContext)(l).user;return Object(u.jsx)("div",{className:"card container mt-4",style:{backgroundColor:d.white},children:Object(u.jsxs)("div",{className:"p-4",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(u.jsx)("div",{children:Object(u.jsx)(v,{song:e.song,title:e.song.title,user:e.song.user,currUser:t,likes:e.song.likes,setLoading:e.setLoading})}),Object(u.jsx)("audio",{controls:!0,style:{width:650},children:Object(u.jsx)("source",{src:e.song.media})}),t.id===e.song.user.id?Object(u.jsx)(S.b,{style:{fontSize:40,cursor:"pointer"},onClick:function(){fetch("/songs/".concat(e.song.id),{method:"DELETE"}),e.setPosts((function(t){return t.filter((function(t){return t.id!==e.song.id}))}))}}):null]})})},A=function(e){var t=Object(c.useContext)(l).user;return Object(u.jsxs)("div",{className:"card container mt-4 p-4 w-75",children:[Object(u.jsx)("h1",{children:"User likes!"}),e.likedSongs.length?e.likedSongs.map((function(n){return Object(u.jsx)(H,{song:n,user:t,setLoading:e.setLoading,setPosts:e.setLiked},n.id)})):Object(u.jsx)("h2",{className:"mx-auto",children:"User has no liked posts"})]})},q=function(e){var t=Object(c.useContext)(l).user;return Object(u.jsxs)("div",{className:"card container mt-4 p-4 w-75",children:[Object(u.jsx)("h1",{children:"User posts!"}),e.createdSongs.length?e.createdSongs.map((function(n){return Object(u.jsx)(H,{song:n,user:t,setLoading:e.setLoading,setPosts:e.setCreated},n.id)})):Object(u.jsx)("h2",{className:"mx-auto",children:"User has no posts"})]})},B=function(e){return Object(u.jsxs)("div",{children:[Object(u.jsx)(q,{createdSongs:e.createdSongs,setCreated:e.setCreated,setLoading:e.setLoading}),Object(u.jsx)(A,{likedSongs:e.likedSongs,setLiked:e.setLiked,setLoading:e.setLoading})]})},R=n(42),M=function(e){var t=Object(a.h)().id,n=Object(c.useContext)(l).user,i=Object(c.useState)({}),o=Object(s.a)(i,2),r=o[0],d=o[1],j=Object(c.useState)(0),b=Object(s.a)(j,2),h=b[0],m=b[1],O=Object(c.useState)([]),f=Object(s.a)(O,2),p=f[0],x=f[1],g=Object(c.useState)([]),y=Object(s.a)(g,2),v=y[0],S=y[1],N=Object(c.useState)(!0),k=Object(s.a)(N,2),C=k[0],L=k[1],E=Object(c.useState)({status:!1,id:null}),T=Object(s.a)(E,2),U=T[0],P=T[1];Object(c.useEffect)((function(){fetch("/api/fetch_user/".concat(t)).then((function(e){return e.json()})).then((function(e){d(e.user),x(e.likes),S(e.songs),m(e.follows),L(!1)})),fetch("/api/already_following",{method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify({followee_id:t,follower_id:n.id})}).then((function(e){return e.json()})).then((function(e){return P({status:e.status,id:e.id})}))}),[t,n]),Object(c.useEffect)((function(){console.log(U)}),[U]);var _=function(){if(U.status)fetch("/likes/".concat(U.id),{method:"DELETE"}).then((function(e){P({status:!1,id:null}),m((function(e){return e-1}))}));else{var e={like:{id:t,liker_id:n.id,type:"User"}};fetch("/likes",{method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){P({status:!0,id:e.id}),m((function(e){return e+1}))}))}};return C?Object(u.jsx)(w.a,{className:"mx-auto mt-5",style:{display:C?"block":"none",width:100,height:100},animation:"grow",variant:"primary"}):Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"card container mt-2 p-4",children:Object(u.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(u.jsxs)("div",{children:[U.status?Object(u.jsx)(R.b,{style:{fontSize:60,cursor:"pointer"},className:"mt-2",onClick:_}):Object(u.jsx)(R.a,{style:{fontSize:60,cursor:"pointer"},className:"mt-2",onClick:_}),Object(u.jsx)("h6",{className:"m-0 ms-4",children:h})]}),Object(u.jsxs)("div",{className:"ms-3 me-5",children:[Object(u.jsxs)("h1",{className:"mb-2",children:[r.username,"'s profile!"]}),Object(u.jsxs)("small",{className:"opacity-75 ms-5",children:["Joined ",new Date(r.created_at).toDateString()]})]})]})}),Object(u.jsx)(B,{likedSongs:p,setLiked:x,createdSongs:v,setCreated:S,setLoading:L})]})},W=(n(57),n(58),function(){var e=Object(c.useState)(null),t=Object(s.a)(e,2),n=t[0],i=t[1],o=Object(c.useState)(JSON.parse(localStorage.getItem("user"))),d=Object(s.a)(o,2),j=d[0],b=d[1];return Object(u.jsx)("div",{children:Object(u.jsx)(r.a,{children:Object(u.jsxs)(l.Provider,{value:{user:j,setUser:b},children:[Object(u.jsx)(h,{}),Object(u.jsx)(f,{notifs:n,setNotifs:i}),Object(u.jsxs)(a.d,{children:[Object(u.jsx)(a.b,{exact:!0,path:"/",element:Object(u.jsx)(D,{element:z})}),Object(u.jsx)(a.b,{exact:!0,path:"/login",element:Object(u.jsx)(F,{element:I,setNotifs:i})}),Object(u.jsx)(a.b,{exact:!0,path:"/signup",element:Object(u.jsx)(F,{element:J,setNotifs:i})}),Object(u.jsx)(a.b,{exact:!0,path:"/user/:id",element:Object(u.jsx)(D,{element:M})})]})]})})})});o.a.render(Object(u.jsx)(W,{}),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.cdd2db9e.chunk.js.map